<!DOCTYPE html>
<html>
<head>
    <title>WW1 Combat Simulator</title>
    <style>
        /* Simplified and organized CSS */
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background-color: #1e1e1e; 
            color: #f0f0f0; 
            display: flex;
        }
        button { 
            padding: 10px 20px; 
            font-size: 16px; 
            margin-bottom: 10px; 
            background-color: #333; 
            color: #f0f0f0; 
            border: none; 
            cursor: pointer;
        }
        button:hover { background-color: #555; }
        .hit { color: red; }
        .block { color: blue; }
        .morale { color: yellow; }
        .cascadea { color: rgb(53, 106, 29); } /* Green for Cascadea */
        .kharkhovia { color: rgb(241, 194, 50); } /* Yellow for Kharkhovia */
        .unit-controls { display: flex; align-items: center; margin-bottom: 10px; }
        .unit-controls span { margin: 0 10px; }
        #combat-section { flex: 1; }
        #board {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }
        /* Hexagon container */
        .hex-container {
            position: relative;
            width: 315px; /* Increased size by 50% */
            height: 365px; /* Increased size by 50% */
            margin: 0 10px;
        }
        /* SVG hexagon styles */
        .hex-svg {
            width: 100%;
            height: 100%;
        }
        .hex-svg polygon {
            fill: transparent;
            stroke: #fff;
            stroke-width: 4;
        }
        .hex-svg .cascadea {
            stroke: rgb(53, 106, 29);
        }
        .hex-svg .kharkhovia {
            stroke: rgb(241, 194, 50);
        }
        /* Units displayed over the hexagon */
        .hex-units {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #f0f0f0;
            font-size: 30px; /* Adjusted font size */
            text-align: center;
            width: 80%; /* Adjust as needed */
            white-space: normal;
            word-wrap: break-word;
            line-height: 1.2;
        }
    </style>
</head>
<body>
    <div id="combat-section">
        <h1>WW1 Combat Simulator</h1>

        <!-- Unit Controls -->
        <div class="unit-controls">
            <span>Cascadea's Units:</span>
            <button onclick="changeUnits('cascadea', 1)">+1 üíÇ‚Äç‚ôÇÔ∏è</button>
            <span id="cascadea-units">1</span>
            <button onclick="changeUnits('cascadea', -1)">-1 üíÇ‚Äç‚ôÇÔ∏è</button>
        </div>
        <div class="unit-controls">
            <span>Kharkhovia's Units:</span>
            <button onclick="changeUnits('kharkhovia', 1)">+1 üíÇ‚Äç‚ôÇÔ∏è</button>
            <span id="kharkhovia-units">1</span>
            <button onclick="changeUnits('kharkhovia', -1)">-1 üíÇ‚Äç‚ôÇÔ∏è</button>
        </div>

        <button id="simulateButton" onclick="simulateCombat()">Simulate Combat</button>
        <div id="output"></div>
    </div>

    <!-- Board Section -->
    <div id="board">
        <div class="hex-container">
            <svg class="hex-svg" viewBox="0 0 100 100">
                <polygon points="50,0 100,25 100,75 50,100 0,75 0,25" class="cascadea"></polygon>
            </svg>
            <div class="hex-units" id="cascadea-hex-units">üíÇ‚Äç‚ôÇÔ∏è</div>
        </div>
        <div class="hex-container">
            <svg class="hex-svg" viewBox="0 0 100 100">
                <polygon points="50,0 100,25 100,75 50,100 0,75 0,25" class="kharkhovia"></polygon>
            </svg>
            <div class="hex-units" id="kharkhovia-hex-units">üíÇ‚Äç‚ôÇÔ∏è</div>
        </div>
    </div>

    <script>
        // Dice values with Morale
        const lightAttackDie = ['Hit', 'Hit', 'Double Hit', 'Morale', 'Morale', 'Miss'];
        const defenceDie = ['Block', 'Block', 'Block', 'Double Block', 'Morale', 'Miss'];
        const infantryEmoji = 'üíÇ‚Äç‚ôÇÔ∏è';

        // Unit counts
        const units = {
            cascadea: 1,
            kharkhovia: 1
        };

        // Function to change units
        function changeUnits(faction, delta) {
            units[faction] = Math.max(units[faction] + delta, 1);
            document.getElementById(`${faction}-units`).innerText = units[faction];
            updateBoardUnits();
        }

        // Update units on the board
        function updateBoardUnits() {
            ['cascadea', 'kharkhovia'].forEach(faction => {
                document.getElementById(`${faction}-hex-units`).textContent = infantryEmoji.repeat(units[faction]);
            });
        }

        // Function to roll a die
        function rollDie(die) {
            return die[Math.floor(Math.random() * die.length)];
        }

        // Function to roll attack and defence for a faction
        function rollForFaction(faction) {
            const attackRoll = rollDie(lightAttackDie);
            const defenceRolls = [rollDie(defenceDie), rollDie(defenceDie)];
            let totalBlocks = 0;
            defenceRolls.forEach(roll => {
                if (roll === 'Block') totalBlocks++;
                else if (roll === 'Double Block') totalBlocks += 2;
            });
            const hits = attackRoll === 'Hit' ? 1 : attackRoll === 'Double Hit' ? 2 : 0;
            return { attackRoll, defenceRolls, totalBlocks, hits };
        }

        // Function to simulate combat
        function simulateCombat() {
            let output = '';

            // Header
            output += `<h2><span class="cascadea">Cascadea (Attacker)</span> vs <span class="kharkhovia">Kharkhovia (Defender)</span></h2>`;
            output += `<p>Cascadea: ${infantryEmoji.repeat(units.cascadea)} (${units.cascadea} units) vs Kharkhovia: ${infantryEmoji.repeat(units.kharkhovia)} (${units.kharkhovia} units)</p>`;

            // Roll for both factions
            const cascadeaRolls = rollForFaction('cascadea');
            const kharkhoviaRolls = rollForFaction('kharkhovia');

            // Output Cascadea's rolls
            output += `<h3>Cascadea's Rolls:</h3>`;
            output += `Attack Roll: <span class="${cascadeaRolls.attackRoll.includes('Hit') ? 'hit' : ''}">${cascadeaRolls.attackRoll}</span><br>`;
            output += `Defence Rolls: ${cascadeaRolls.defenceRolls.map(roll => `<span class="${roll.includes('Block') ? 'block' : ''}">${roll}</span>`).join(', ')}<br>`;
            output += `Blocks: ${cascadeaRolls.totalBlocks}<br>`;

            // Output Kharkhovia's rolls
            output += `<h3>Kharkhovia's Rolls:</h3>`;
            output += `Attack Roll: <span class="${kharkhoviaRolls.attackRoll.includes('Hit') ? 'hit' : ''}">${kharkhoviaRolls.attackRoll}</span><br>`;
            output += `Defence Rolls: ${kharkhoviaRolls.defenceRolls.map(roll => `<span class="${roll.includes('Block') ? 'block' : ''}">${roll}</span>`).join(', ')}<br>`;
            output += `Blocks: ${kharkhoviaRolls.totalBlocks}<br>`;

            // Calculate damage
            const cascadeaDamage = Math.max(kharkhoviaRolls.hits - cascadeaRolls.totalBlocks, 0);
            const kharkhoviaDamage = Math.max(cascadeaRolls.hits - kharkhoviaRolls.totalBlocks, 0);

            // Combat Resolution
            output += `<h3>Combat Resolution:</h3>`;
            if (cascadeaDamage >= units.cascadea) {
                output += `<p class="kharkhovia">Cascadea's infantry is eliminated!</p>`;
                units.cascadea = 0;
            } else {
                output += `<p>Cascadea takes ${cascadeaDamage} damage but survives.</p>`;
                units.cascadea -= cascadeaDamage;
            }

            if (kharkhoviaDamage >= units.kharkhovia) {
                output += `<p class="cascadea">Kharkhovia's infantry is eliminated!</p>`;
                units.kharkhovia = 0;
            } else {
                output += `<p>Kharkhovia takes ${kharkhoviaDamage} damage but survives.</p>`;
                units.kharkhovia -= kharkhoviaDamage;
            }

            // Update unit counts and board
            document.getElementById('cascadea-units').innerText = units.cascadea;
            document.getElementById('kharkhovia-units').innerText = units.kharkhovia;
            updateBoardUnits();

            // Update output
            document.getElementById('output').innerHTML = output;
        }
    </script>
</body>
</html>
